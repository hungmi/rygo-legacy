<%= form_with model: [:admin, order_item], local: true, class: "mb-5" do |f| %>
  <% ordered_cloth_id = f.object.cloth_id ? f.object.cloth_id : params[:cloth_id] %>
  <div class="row">
    <div class="col-md-6" id="orderItemImgCarousel">
      <% if ordered_cloth_id.present? && (cloth = Cloth.find(ordered_cloth_id)).present? %>
        <%= render "admin/cloths/cloth_img_carousel", cloth: cloth %>
      <% else %>
        <%= image_tag "https://dummyimage.com/600x400/000000/fff&text=衣服品番を選択してください", class: "w-100" %>
      <% end %>
    </div>
    <div class="col-md-6">
      <div class="form-group <%= order_item.errors[:cloth_id].present? ? 'has-danger' : '' %>">
        <%= f.label :cloth_id %>
        <%= f.collection_select :cloth_id, policy_scope(Cloth), :id, :code, { prompt: true, selected: ordered_cloth_id }, class: "form-control #{order_item.errors[:cloth_id].present? ? 'is-invalid' : ''}" %>
        <% if order_item.errors[:cloth_id].present? %>
    	    <div class="invalid-feedback">
    	      <%= order_item.errors[:cloth_id].join(", ") %>
    	    </div>
        <% end %>
      </div>
      <div class="form-group <%= order_item.errors[:amount].present? ? 'has-danger' : '' %>">
        <%= f.label :amount %>
        <%= f.text_field :amount, class: "form-control #{order_item.errors[:amount].present? ? 'is-invalid' : ''}" %>
        <% if order_item.errors[:amount].present? %>
    	    <div class="invalid-feedback">
    	      <%= order_item.errors[:amount].join(", ") %>
    	    </div>
        <% end %>
      </div>
      <div class="form-group <%= order_item.errors[:deliver_date].present? ? 'has-danger' : '' %>">
        <%= f.label :deliver_date %>
        <%= f.text_field :deliver_date, class: "form-control #{order_item.errors[:deliver_date].present? ? 'is-invalid' : ''}" %>
        <% if order_item.errors[:deliver_date].present? %>
    	    <div class="invalid-feedback">
    	      <%= order_item.errors[:deliver_date].join(", ") %>
    	    </div>
        <% end %>
      </div>
      <div class="form-group <%= order_item.errors[:status].present? ? 'has-danger' : '' %>">
        <%= f.label :status %>
        <%= f.collection_select :status, I18n.t("activerecord.order_item_status"), :first, :last, {}, class: "form-control #{order_item.errors[:status].present? ? 'is-invalid' : ''}" %>
        <% if order_item.errors[:status].present? %>
    	    <div class="invalid-feedback">
    	      <%= order_item.errors[:status].join(", ") %>
    	    </div>
        <% end %>
      </div>
      <%= link_to "キャンセル", admin_order_items_path, class: "btn btn-link text-danger" %>
      <%= f.submit class: "btn btn-primary float-right" %>
    </div>
  </div>
<% end %>